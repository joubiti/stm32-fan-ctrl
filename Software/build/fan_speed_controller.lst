ARM GAS  /tmp/ccmH5TKP.s 			page 1


   1              		.cpu cortex-m0plus
   2              		.arch armv6s-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 0
  12              		.eabi_attribute 18, 4
  13              		.file	"fan_speed_controller.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.file 1 "Core/Src/fan_speed_controller.c"
  18              		.section	.text.fan_speed_controller_init,"ax",%progbits
  19              		.align	1
  20              		.global	fan_speed_controller_init
  21              		.syntax unified
  22              		.code	16
  23              		.thumb_func
  25              	fan_speed_controller_init:
  26              	.LVL0:
  27              	.LFB310:
   1:Core/Src/fan_speed_controller.c **** /**
   2:Core/Src/fan_speed_controller.c ****  * @file fan_speed_controller.c
   3:Core/Src/fan_speed_controller.c ****  * @author your name (you@domain.com)
   4:Core/Src/fan_speed_controller.c ****  * @brief 
   5:Core/Src/fan_speed_controller.c ****  * @version 0.1
   6:Core/Src/fan_speed_controller.c ****  * @date 2025-09-13
   7:Core/Src/fan_speed_controller.c ****  * 
   8:Core/Src/fan_speed_controller.c ****  * @copyright Copyright (c) 2025
   9:Core/Src/fan_speed_controller.c ****  * 
  10:Core/Src/fan_speed_controller.c ****  */
  11:Core/Src/fan_speed_controller.c **** 
  12:Core/Src/fan_speed_controller.c **** #include "fan_speed_controller.h"
  13:Core/Src/fan_speed_controller.c **** 
  14:Core/Src/fan_speed_controller.c **** #include "stdlib.h"
  15:Core/Src/fan_speed_controller.c **** 
  16:Core/Src/fan_speed_controller.c **** #define FAN_PWM_CHANNEL TIM_CHANNEL_1
  17:Core/Src/fan_speed_controller.c **** 
  18:Core/Src/fan_speed_controller.c **** /**
  19:Core/Src/fan_speed_controller.c ****  * @brief Macro helper to get ARR register value from PWM duty cycle
  20:Core/Src/fan_speed_controller.c ****  * 
  21:Core/Src/fan_speed_controller.c ****  */
  22:Core/Src/fan_speed_controller.c **** #define get_pwm_compare_value(x) (uint16_t)((x * 24999)/100)
  23:Core/Src/fan_speed_controller.c **** 
  24:Core/Src/fan_speed_controller.c **** 
  25:Core/Src/fan_speed_controller.c **** void fan_speed_controller_init(fan_controller_t* fan, TIM_HandleTypeDef* htim)
  26:Core/Src/fan_speed_controller.c **** {
  28              		.loc 1 26 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		.loc 1 26 1 is_stmt 0 view .LVU1
ARM GAS  /tmp/ccmH5TKP.s 			page 2


  33 0000 10B5     		push	{r4, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 4, -8
  37              		.cfi_offset 14, -4
  38 0002 0400     		movs	r4, r0
  39 0004 0800     		movs	r0, r1
  40              	.LVL1:
  27:Core/Src/fan_speed_controller.c ****     fan->htim = htim;
  41              		.loc 1 27 5 is_stmt 1 view .LVU2
  42              		.loc 1 27 15 is_stmt 0 view .LVU3
  43 0006 2160     		str	r1, [r4]
  28:Core/Src/fan_speed_controller.c ****     fan->rpm_measured = 0;
  44              		.loc 1 28 5 is_stmt 1 view .LVU4
  45              		.loc 1 28 23 is_stmt 0 view .LVU5
  46 0008 0023     		movs	r3, #0
  47 000a E380     		strh	r3, [r4, #6]
  29:Core/Src/fan_speed_controller.c ****     fan->rpm_requested = 0;
  48              		.loc 1 29 5 is_stmt 1 view .LVU6
  49              		.loc 1 29 24 is_stmt 0 view .LVU7
  50 000c A380     		strh	r3, [r4, #4]
  30:Core/Src/fan_speed_controller.c **** 
  31:Core/Src/fan_speed_controller.c ****     // start PWM timer
  32:Core/Src/fan_speed_controller.c ****     HAL_TIM_Base_Start(fan->htim);
  51              		.loc 1 32 5 is_stmt 1 view .LVU8
  52 000e FFF7FEFF 		bl	HAL_TIM_Base_Start
  53              	.LVL2:
  33:Core/Src/fan_speed_controller.c ****     HAL_TIM_PWM_Start(fan->htim, TIM_CHANNEL_1);
  54              		.loc 1 33 5 view .LVU9
  55 0012 2068     		ldr	r0, [r4]
  56 0014 0021     		movs	r1, #0
  57 0016 FFF7FEFF 		bl	HAL_TIM_PWM_Start
  58              	.LVL3:
  34:Core/Src/fan_speed_controller.c **** }
  59              		.loc 1 34 1 is_stmt 0 view .LVU10
  60              		@ sp needed
  61              	.LVL4:
  62              		.loc 1 34 1 view .LVU11
  63 001a 10BD     		pop	{r4, pc}
  64              		.cfi_endproc
  65              	.LFE310:
  67              		.section	.text.fan_set_rpm_percent,"ax",%progbits
  68              		.align	1
  69              		.global	fan_set_rpm_percent
  70              		.syntax unified
  71              		.code	16
  72              		.thumb_func
  74              	fan_set_rpm_percent:
  75              	.LVL5:
  76              	.LFB311:
  35:Core/Src/fan_speed_controller.c **** 
  36:Core/Src/fan_speed_controller.c **** 
  37:Core/Src/fan_speed_controller.c **** void fan_set_rpm_percent(fan_controller_t* fan, uint8_t percent)
  38:Core/Src/fan_speed_controller.c **** {
  77              		.loc 1 38 1 is_stmt 1 view -0
  78              		.cfi_startproc
  79              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccmH5TKP.s 			page 3


  80              		@ frame_needed = 0, uses_anonymous_args = 0
  81              		.loc 1 38 1 is_stmt 0 view .LVU13
  82 0000 10B5     		push	{r4, lr}
  83              	.LCFI1:
  84              		.cfi_def_cfa_offset 8
  85              		.cfi_offset 4, -8
  86              		.cfi_offset 14, -4
  87 0002 0400     		movs	r4, r0
  39:Core/Src/fan_speed_controller.c ****     if(percent > 100)
  88              		.loc 1 39 5 is_stmt 1 view .LVU14
  89              		.loc 1 39 7 is_stmt 0 view .LVU15
  90 0004 6429     		cmp	r1, #100
  91 0006 00D9     		bls	.L3
  40:Core/Src/fan_speed_controller.c ****         percent = 100;
  92              		.loc 1 40 17 view .LVU16
  93 0008 6421     		movs	r1, #100
  94              	.LVL6:
  95              	.L3:
  41:Core/Src/fan_speed_controller.c ****     uint8_t scaled_percent = 100 - percent;
  96              		.loc 1 41 5 is_stmt 1 view .LVU17
  97              		.loc 1 41 13 is_stmt 0 view .LVU18
  98 000a 6423     		movs	r3, #100
  99 000c 591A     		subs	r1, r3, r1
 100              	.LVL7:
 101              		.loc 1 41 13 view .LVU19
 102 000e C9B2     		uxtb	r1, r1
 103              	.LVL8:
  42:Core/Src/fan_speed_controller.c ****     __HAL_TIM_SET_COMPARE(fan->htim, FAN_PWM_CHANNEL, get_pwm_compare_value(scaled_percent));
 104              		.loc 1 42 5 is_stmt 1 view .LVU20
 105 0010 0548     		ldr	r0, .L5
 106              	.LVL9:
 107              		.loc 1 42 5 is_stmt 0 view .LVU21
 108 0012 4843     		muls	r0, r1
 109 0014 6421     		movs	r1, #100
 110              	.LVL10:
 111              		.loc 1 42 5 view .LVU22
 112 0016 FFF7FEFF 		bl	__aeabi_idiv
 113              	.LVL11:
 114              		.loc 1 42 5 view .LVU23
 115 001a 2368     		ldr	r3, [r4]
 116 001c 1B68     		ldr	r3, [r3]
 117 001e 0004     		lsls	r0, r0, #16
 118 0020 000C     		lsrs	r0, r0, #16
 119 0022 5863     		str	r0, [r3, #52]
  43:Core/Src/fan_speed_controller.c **** }
 120              		.loc 1 43 1 view .LVU24
 121              		@ sp needed
 122              	.LVL12:
 123              		.loc 1 43 1 view .LVU25
 124 0024 10BD     		pop	{r4, pc}
 125              	.L6:
 126 0026 C046     		.align	2
 127              	.L5:
 128 0028 A7610000 		.word	24999
 129              		.cfi_endproc
 130              	.LFE311:
 132              		.text
ARM GAS  /tmp/ccmH5TKP.s 			page 4


 133              	.Letext0:
 134              		.file 2 "/home/achraf/Desktop/Toolchain/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/arm-none-
 135              		.file 3 "/home/achraf/Desktop/Toolchain/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/arm-none-
 136              		.file 4 "Drivers/CMSIS/Device/ST/STM32G0xx/Include/stm32g070xx.h"
 137              		.file 5 "Drivers/STM32G0xx_HAL_Driver/Inc/stm32g0xx_hal_def.h"
 138              		.file 6 "Drivers/STM32G0xx_HAL_Driver/Inc/stm32g0xx_hal_dma.h"
 139              		.file 7 "Drivers/STM32G0xx_HAL_Driver/Inc/stm32g0xx_hal_tim.h"
 140              		.file 8 "Core/Inc/fan_speed_controller.h"
 141              		.file 9 "Drivers/STM32G0xx_HAL_Driver/Inc/stm32g0xx_ll_dma.h"
ARM GAS  /tmp/ccmH5TKP.s 			page 5


DEFINED SYMBOLS
                            *ABS*:00000000 fan_speed_controller.c
     /tmp/ccmH5TKP.s:19     .text.fan_speed_controller_init:00000000 $t
     /tmp/ccmH5TKP.s:25     .text.fan_speed_controller_init:00000000 fan_speed_controller_init
     /tmp/ccmH5TKP.s:68     .text.fan_set_rpm_percent:00000000 $t
     /tmp/ccmH5TKP.s:74     .text.fan_set_rpm_percent:00000000 fan_set_rpm_percent
     /tmp/ccmH5TKP.s:128    .text.fan_set_rpm_percent:00000028 $d

UNDEFINED SYMBOLS
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
__aeabi_idiv
